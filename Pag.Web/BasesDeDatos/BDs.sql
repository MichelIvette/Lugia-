-- ======================================================
-- 1️⃣ BASE DE DATOS
-- ======================================================
CREATE DATABASE IF NOT EXISTS escuela;
USE escuela;

-- ======================================================
-- 2️⃣ TABLA USUARIO
-- ======================================================
CREATE TABLE IF NOT EXISTS usuario (
    usuario_id INT AUTO_INCREMENT PRIMARY KEY,
    usuario_nombre VARCHAR(50) NOT NULL UNIQUE,
    usuario_clave VARCHAR(255) NOT NULL 
);

INSERT INTO usuario (usuario_nombre, usuario_clave) VALUES
('admin', MD5('admin')),
('cliente', MD5('cliente')),
('recepcionista', MD5('recepcionista')),
('empleado', MD5('empleado'));

-- ======================================================
-- 3️⃣ TABLA EMPLEADOS
-- ======================================================
CREATE TABLE EMPLEADOS (
	RFC_EMP VARCHAR (13) NOT NULL PRIMARY KEY,
	NOMB_EMP VARCHAR(20),
	AP_EMP VARCHAR (20) NOT NULL,
	AM_EMP VARCHAR (20) NOT NULL,
	PUESTO VARCHAR (20) NOT NULL,
	TURNO ENUM('MATUTINO','VESPERTINO') NOT NULL,
	DESCANSOS VARCHAR (30) NOT NULL,
	SEXO ENUM ('MASCULINO', 'FEMENINO') NOT NULL,
	FECHA_NAC DATE NOT NULL,
	TEL_PERSONAL BIGINT NOT NULL,
	CALLE VARCHAR (20) NOT NULL,
	NUMERO INT NOT NULL,
	COLONIA VARCHAR (30) NOT NULL,
	ALCALDIA VARCHAR (20) NOT NULL
);

-- ======================================================
-- 4️⃣ TABLA CONTRATACIÓN
-- ======================================================
CREATE TABLE CONTRATACION (
	TIPO_CONTRATACION VARCHAR (10) NOT NULL PRIMARY KEY,
	PRECIO INT NOT NULL,
	DESC_BENEFICIOS VARCHAR (50) NOT NULL
);

-- ======================================================
-- 5️⃣ TABLA CLIENTES (ya sin datos de pago)
-- ======================================================
CREATE TABLE CLIENTES (
	RFC_CLIENTE VARCHAR (13) NOT NULL PRIMARY KEY,
	NOMB_CLI VARCHAR (10) NOT NULL,
	AP_CLI VARCHAR (10) NOT NULL,
	AM_CLI VARCHAR (10) NOT NULL,
	FECHA_NAC DATE NOT NULL,
	CALLE VARCHAR (20) NOT NULL,
	NUMERO INT NOT NULL,
	COLONIA VARCHAR (30) NOT NULL,
	ALCALDIA VARCHAR (20) NOT NULL,
	PERMISO ENUM ('SI', 'NO', 'EN TRÁMITE'),
	OBSERVACIONES VARCHAR (30),
	CORREO VARCHAR (50) NOT NULL
);

-- ======================================================
-- 6️⃣ TABLA PAGOS (nueva)
-- ======================================================
CREATE TABLE PAGOS (
    RFC_CLIENTE VARCHAR(13) NOT NULL,
    FECHA_PAGO DATE NOT NULL,
    TIPO_CONTRATACION VARCHAR(10) NOT NULL,
    TOTAL_PAGO INT NOT NULL,
    FORMA_PAGO ENUM ('DEBITO', 'CRÉDITO', 'EFECTIVO', 'TRANSFERENCIA'),
    REEMBOLSO BOOLEAN DEFAULT FALSE,
    PRIMARY KEY (RFC_CLIENTE, FECHA_PAGO),
    FOREIGN KEY (RFC_CLIENTE) REFERENCES CLIENTES(RFC_CLIENTE),
    FOREIGN KEY (TIPO_CONTRATACION) REFERENCES CONTRATACION(TIPO_CONTRATACION)
);

-- ======================================================
-- 7️⃣ TABLA AGENDA (ya apunta a PAGOS)
-- ======================================================
CREATE TABLE AGENDA (
    RFC_EMP VARCHAR(13) NOT NULL,
    FECHA DATE NOT NULL,
    HORA TIME NOT NULL,
    RFC_CLIENTE VARCHAR(13) NOT NULL,
    FECHA_PAGO DATE NOT NULL,
    ACTIVIDAD ENUM('EXAMEN', 'LECCIÓN'),
    KM_RECORRIDOS INT,
    NOTAS VARCHAR(50),
    EXAM_TEO INT,
    EXAM_PRAC INT,
    NOTAS_RESULTADO VARCHAR(50),
    PRIMARY KEY (FECHA, HORA, RFC_EMP),
    FOREIGN KEY (RFC_EMP) REFERENCES EMPLEADOS(RFC_EMP),
    FOREIGN KEY (RFC_CLIENTE, FECHA_PAGO) REFERENCES PAGOS(RFC_CLIENTE, FECHA_PAGO)
);

INSERT INTO CONTRATACION (TIPO_CONTRATACION, PRECIO, DESC_BENEFICIOS)
VALUES 
('BÁSICO', 2000, '7 DÍAS, 3HRS X DÍA'),
('INTERMEDIO', 3500, '12 DÍAS, 3.5HRS X DÍA'),
('PREMIUM', 5000, '18 DÍAS, 4HRS X DÍA');


INSERT INTO CLIENTES (RFC_CLIENTE, NOMB_CLI, AP_CLI, AM_CLI, FECHA_NAC, CALLE, NUMERO, COLONIA, ALCALDIA, PERMISO, OBSERVACIONES, CORREO)
VALUES
('JUAP910101HDF', 'JUAN', 'PÉREZ', 'ALVAREZ', '1991-01-01', 'REFORMA', 100, 'CENTRO', 'CUAUHTÉMOC', 'SI', 'ANSIEDAD GENERALIZADA', 'jperez@hotmail.com'),
('MARG920202MDF', 'MARÍA', 'GÓMEZ', 'RAMÍREZ', '1992-02-02', 'INSURGENTES', 200, 'DEL VALLE', 'BENITO JUÁREZ', 'SI', 'LESIÓN EN BRAZO DERECHO', 'mgomez@gmail.com'),
('LUIC930303HDF', 'LUIS', 'CANO', 'SANTOS', '1993-03-03', 'MIGUEL HIDALGO', 35, 'POLANCO', 'MIGUEL HIDALGO', 'EN TRÁMITE', 'LESIÓN DE RODILLA IZQUIERDA', 'lcano@outlook.com'),
('SAND940404MDF', 'SANDRA', 'MARTÍNEZ', 'LARA', '1994-04-04', 'DIVISIÓN DEL NORTE', 80, 'PORTALES', 'BENITO JUÁREZ', 'NO', 'DIABETES', 'smartinez@yahoo.com'),
('CARF950505HDF', 'CARLOS', 'FLORES', 'MEJÍA', '1995-05-05', 'ZARAGOZA', 150, 'MOCTEZUMA', 'VENUSTIANO CARRANZA', 'SI', 'ANSIEDAD', 'cflores@hotmail.com'),
('ANEL960606MDF', 'ANA', 'LEÓN', 'SILVA', '1996-06-06', 'AV. UNIVERSIDAD', 77, 'COPILCO', 'COYOACÁN', 'SI', 'VÉRTIGO LEVE', 'aleon@gmail.com'),
('JORR970707HDF', 'JORGE', 'ROJAS', 'REYES', '1997-07-07', 'PATRIOTISMO', 99, 'NÁPOLES', 'BENITO JUÁREZ', 'SI', 'HIPERTENSIÓN CONTROLADA', 'jrojas@outlook.com'),
('LUIM980808MDF', 'LUISA', 'MENDOZA', 'TORRES', '1998-08-08', 'TLALPAN', 55, 'LA JOYA', 'TLALPAN', 'EN TRÁMITE', 'VISTA REDUCIDA (USA LENTES)', 'lmendoza@gmail.com'),
('RAFM990909HDF', 'RAFAEL', 'MORA', 'CASTRO', '1999-09-09', 'EJE CENTRAL', 120, 'OBRERA', 'CUAUHTÉMOC', 'SI', NULL, 'rmora@hotmail.com'),
('VERC000101MDF', 'VERÓNICA', 'CARRILLO', 'NAVARRO', '2000-01-01', 'CENTENARIO', 67, 'SAN RAFAEL', 'CUAUHTÉMOC', 'SI', 'EPILEPSIA LEVE (CONTROLADA)', 'vcarrillo@yahoo.com'),
('OSCJ010202HDF', 'OSCAR', 'JUÁREZ', 'VALDÉS', '2001-02-02', 'CUITLAHUAC', 45, 'TACUBA', 'MIGUEL HIDALGO', 'NO', 'DIABETES', 'ojuarez@outlook.com');


INSERT INTO EMPLEADOS 
(RFC_EMP, NOMB_EMP, AP_EMP, AM_EMP, PUESTO, TURNO, DESCANSOS, SEXO, FECHA_NAC, TEL_PERSONAL, CALLE, NUMERO, COLONIA, ALCALDIA)
VALUES
('GARC900101HDF', 'ANA', 'GARCÍA', 'LOPEZ', 'INSTRUCTORA', 'MATUTINO', 'LUNES,MARTES', 'FEMENINO', '1990-01-01', 5541234567, 'MIGUEL HIDALGO', 12, 'DEL VALLE', 'BENITO JUÁREZ'),
('LOPE920304MDF', 'LUIS', 'LOPEZ', 'MORALES', 'ADMINISTRADOR', 'MATUTINO', 'SÁBADO,DOMINGO', 'MASCULINO', '1992-03-04', 5512345678, 'INSURGENTES SUR', 245, 'NÁPOLES', 'BENITO JUÁREZ'),
('FERJ850715HDF', 'JUAN', 'FERNANDEZ', 'RODRIGUEZ', 'RECEPCIONISTA', 'MATUTINO', 'SÁBADO,LUNES', 'MASCULINO', '1985-07-15', 5556677889, 'CENTENARIO', 33, 'ROMA NORTE', 'CUAUHTÉMOC'),
('VELM870610HDF', 'MARIO', 'VELAZQUEZ', 'MARTINEZ', 'INSTRUCTOR', 'MATUTINO', 'MIÉRCOLES,VIERNES', 'MASCULINO', '1987-06-10', 5578912345, 'TACUBA', 77, 'SAN RAFAEL', 'CUAUHTÉMOC'),
('REYG940420HDF', 'GABRIEL', 'REYES', 'GUTIÉRREZ', 'INSTRUCTOR', 'MATUTINO', 'SÁBADO,DOMINGO', 'MASCULINO', '1994-04-20', 5522233344, 'FRAY SERVANDO', 88, 'OBRERA', 'CUAUHTÉMOC'),
('SALM860927MDF', 'MONICA', 'SALAZAR', 'MORA', 'INSTRUCTORA', 'VESPERTINO', 'VIERNES,SÁBADO', 'FEMENINO', '1986-09-27', 5533344455, 'EJE CENTRAL', 333, 'CENTRO', 'CUAUHTÉMOC'),
('LOZR970708HDF', 'RAFAEL', 'LOZANO', 'RIVERA', 'INSTRUCTOR', 'VESPERTINO', 'MARTES,JUEVES', 'MASCULINO', '1997-07-08', 5544455566, 'PATRIOTISMO', 11, 'ESPARTACO', 'COYOACÁN'),
('MOSE030526A50', 'ERICK', 'MONROY', 'SANTANA', 'SUPERVISOR', 'MATUTINO', 'SÁBADO,DOMINGO', 'MASCULINO', '2003-05-26', 5540608099, 'LAS FLORES', 9, 'PASCUAL', 'IZTACALCO'),
('RAMC880908MDF', 'CLAUDIA', 'RAMIREZ', 'CASTILLO', 'RECEPCIONISTA', 'VESPERTINO', 'MARTES,DOMINGO', 'FEMENINO', '1988-09-08', 5567891234, 'DIVISIÓN DEL NORTE', 140, 'PORTALES', 'BENITO JUÁREZ'),
('ORTA930505MDF', 'TERESA', 'ORTEGA', 'AGUILAR', 'LIMPIEZA', 'VESPERTINO', 'SÁBADO, MIÉRCOLES', 'FEMENINO', '1993-05-05', 5589123456, 'ZARAGOZA', 180, 'MOCTEZUMA', 'VENUSTIANO CARRANZA'),
('CRUZ930409HDF', 'DAVID', 'CRUZ', 'MARTÍNEZ', 'LIMPIEZA', 'MATUTINO', 'LUNES,DOMINGO', 'MASCULINO', '1993-04-09', 5534567890, 'AV. OCEANÍA', 72, 'MOCTEZUMA', 'VENUSTIANO CARRANZA');


INSERT INTO PAGOS (RFC_CLIENTE, FECHA_PAGO, TIPO_CONTRATACION, TOTAL_PAGO, FORMA_PAGO, REEMBOLSO)
VALUES
('JUAP910101HDF', '2025-06-01', 'BÁSICO', 2000, 'EFECTIVO', FALSE),
('MARG920202MDF', '2025-06-05', 'PREMIUM', 5000, 'TRANSFERENCIA', FALSE),
('LUIC930303HDF', '2025-06-10', 'INTERMEDIO', 3500, 'DÉBITO', TRUE),
('SAND940404MDF', '2025-06-12', 'PREMIUM', 5000, 'EFECTIVO', FALSE),
('CARF950505HDF', '2025-06-15', 'BÁSICO', 2000, 'TRANSFERENCIA', FALSE),
('ANEL960606MDF', '2025-06-18', 'INTERMEDIO', 3500, 'CRÉDITO', TRUE),
('JORR970707HDF', '2025-06-20', 'PREMIUM', 5000, 'TRANSFERENCIA', FALSE),
('LUIM980808MDF', '2025-06-22', 'BÁSICO', 2000, 'EFECTIVO', TRUE),
('RAFM990909HDF', '2025-06-25', 'INTERMEDIO', 3500, 'CRÉDITO', FALSE),
('VERC000101MDF', '2025-06-28', 'PREMIUM', 5000, 'TRANSFERENCIA', FALSE),
('OSCJ010202HDF', '2025-06-30', 'BÁSICO', 2000, 'EFECTIVO', FALSE);


INSERT INTO AGENDA 
(RFC_EMP, FECHA, HORA, RFC_CLIENTE, FECHA_PAGO, ACTIVIDAD, KM_RECORRIDOS, NOTAS, EXAM_TEO, EXAM_PRAC, NOTAS_RESULTADO)
VALUES
('VELM870610HDF', '2025-06-10', '08:00:00', 'JUAP910101HDF', '2025-06-01', 'LECCIÓN', 10, 'Buen avance', NULL, NULL, NULL),
('VELM870610HDF', '2025-06-11', '08:00:00', 'MARG920202MDF', '2025-06-05', 'EXAMEN', 15, NULL, 85, 90, 'Aprobado'),
('REYG940420HDF', '2025-06-12', '09:00:00', 'LUIC930303HDF', '2025-06-10', 'LECCIÓN', 12, 'Trabajar curvas', NULL, NULL, NULL),
('SALM860927MDF', '2025-06-12', '15:00:00', 'SAND940404MDF', '2025-06-12', 'EXAMEN', 8, 'Dolor en brazo', 90, 75, 'Aprobado'),
('LOZR970708HDF', '2025-06-13', '12:00:00', 'CARF950505HDF', '2025-06-15', 'LECCIÓN', 20, 'Buen ritmo', NULL, NULL, NULL),
('SALM860927MDF', '2025-06-11', '11:00:00', 'JUAP910101HDF', '2025-06-01', 'LECCIÓN', 5, 'Ataque de ansiedad', NULL, NULL, NULL),
('REYG940420HDF', '2025-06-11', '11:00:00', 'JUAP910101HDF', '2025-06-01', 'LECCIÓN', 5, 'Ataque de ansiedad', NULL, NULL, NULL),
('LOZR970708HDF', '2025-06-13', '16:00:00', 'CARF950505HDF', '2025-06-15', 'LECCIÓN', 20, 'Buen ritmo', 50, 35, 'Reprobado'),
('SALM860927MDF', '2025-06-13', '16:00:00', 'RAFM990909HDF', '2025-06-25', 'LECCIÓN', 20, 'Buen ritmo', NULL, NULL, NULL),
('VELM870610HDF', '2025-06-11', '11:00:00', 'OSCJ010202HDF', '2025-06-30', 'LECCIÓN', 5, 'Buen avance', NULL, NULL, NULL);




